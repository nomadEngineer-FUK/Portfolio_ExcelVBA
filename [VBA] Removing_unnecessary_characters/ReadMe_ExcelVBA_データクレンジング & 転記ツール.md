# Excel VBA Macro Collection: データクリーンアップ & 転記ツール

## 概要

このリポジトリは、Excel VBA (Visual Basic for Applications) で開発された一連のマクロツールを含んでいます。本ツールは、特定のデータシートから不要な文字列を検出し、クリーンアップし、フラグ付けを行い、最終的に整形されたデータを別シートに自動的に転記する機能を提供します。データの品質管理と効率的なデータ処理を目的としています。

## 主な機能

本ツールは以下の主要な機能を提供します。

1.  **ファイル選択とシートの初期設定**:

    - ユーザーに処理対象の Excel ファイルを選択させます。
    - 定義済みのシート名（例: "企・店コード・CPID をキーにして削除"）に基づいてワークシートオブジェクトを初期化します。

2.  **「修正有無」列の自動追加**:

    - 各処理対象シートにおいて、「修正有無」列の存在をチェックします。
    - もし「修正有無」列が存在しない場合、新しい列を挿入し、「修正有無」「修正内容」「修正日」というヘッダーを自動的に追加します。

3.  **不要文字列の検出とクリーンアップ**:

    - 指定された列（`arryColNum` に含まれる列）のセル内容を 1 文字ずつチェックします。
    - **先頭のシングルクォーテーション**: セルの先頭にシングルクォーテーション (`'`) がある場合、これを検出します。
    - **型不一致文字**:
      - "決済用 CPID" または "IPID" ヘッダーの列では、数字以外の文字を検出します。
      - それ以外のヘッダーの列では、英数字 (`A-Z, a-z, 0-9`) 以外の文字を検出します。
    - 検出された不要文字はセルから削除され、クリーンなデータが元のセルに文字列として書き戻されます。

4.  **フラグ付けと修正情報の記録**:

    - 不要な文字列や先頭のシングルクォーテーションが検出された行に対し、以下を記録します。
      - **修正有無**: 「○」
      - **修正内容**: 検出された不要文字（例: "先頭 SQ", "空白" など、可視化された形式）
      - **修正日**: 処理実行日

5.  **整形データの別シートへの転記**:

    - 「修正有無」列に「○」が付与された行のデータを抽出します。
    - 抽出されたデータを、現在のブック内の「修正済データ一覧」シートに転記します。
    - 転記時には、ヘッダー名に基づいてデータの対応付けが行われます。

6.  **オートフィルターの設定**:
    - 処理後、対象シートにオートフィルターが設定され、データの確認や絞り込みが容易になります。

## 動作イメージ
